{% extends 'editor/base.html' %}

{% block title %}{{ document.title }}{% endblock %}

{% block extra_css %}
{% load static %}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/theme/monokai.min.css">
<link rel="stylesheet" href="{% static 'css/editor.css' %}">
{% endblock %}

{% block content %}
<div class="editor-header">
    <div class="document-title">{{ document.title }}
        {% if not can_edit %}
        <span style="margin-left: 12px; font-size: 12px; padding: 4px 8px; background: #1e3a8a; color: #60a5fa; border-radius: 12px;">
            View Only
        </span>
        {% endif %}
    </div>
    <div class="users-container">
        {% if is_owner %}
        <a href="{% url 'manage_collaborators' document.id %}" style="color: #3b82f6; text-decoration: none; padding: 4px 8px; background: #1e3a8a; color: #60a5fa; border-radius: 12px;">
            ðŸ‘¥ Manage Collaborators
        </a>
        {% endif %}
        <div id="usersList"></div>
        <div class="connection-status" id="connectionStatus">Connecting...</div>
    </div>
</div>

<div class="editor-container">
    <textarea id="codeEditor"></textarea>
</div>
{% endblock %}

{% block extra_js %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/python/python.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/javascript/javascript.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/clike/clike.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/go/go.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/rust/rust.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/ruby/ruby.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/php/php.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/htmlmixed/htmlmixed.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/css/css.min.js"></script>

<script>
    window.EDITOR_CONFIG = {
        documentId: '{{ document_id }}',
        documentLanguage: '{{ document.language }}',
        canEdit: {{ can_edit|yesno:"true,false" }}
    };
</script>
<script src="{% static 'js/editor.js' %}"></script>
{% endblock %}